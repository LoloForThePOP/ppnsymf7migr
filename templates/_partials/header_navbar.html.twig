{# Header Navbar #}

<header>

  <nav class="navbar navbar-expand-md fixed-top navbar-light theme-surface" style="border-bottom: 2px solid var(--theme-accent);">

    <div class="container-fluid ps-3 ps-md-5">

      {# Website Logo #}

      <a class="navbar-brand py-0 me-0 me-lg-4" href="/">

        {% include "_partials/propon_logo_inline.html.twig" with {
          logoClass: 'website-logo propon-logo',
          logoTitle: 'Propon'
        } %}

      </a>

      <style>

        .website-logo{

          width: 88px;
          height: auto;
          display: block;

        }
      
      </style>

      {# Static Menu #}

      <ul class="navbar-nav d-flex align-items-center static-menu fw-bold" style="flex-direction: inherit;">

        {# Add a Project Button #}
          
          <li class="nav-item fs-5 me-4 d-none d-md-inline">

            <a href="{{ path('create_project_presentation') }}" class="create-presentation-button btn">

                <svg class="bordered-plus-sign" viewBox="0 0 24 24" aria-hidden="true" focusable="false" width="15" height="15">
                  <path d="M11.9999 6.84133C12.5571 6.84133 13.0088 7.29306 13.0088 7.85029V10.991H16.1498C16.707 10.991 17.1588 11.4428 17.1588 12C17.1588 12.5572 16.707 13.009 16.1498 13.009H13.0088V16.1497C13.0088 16.7069 12.5571 17.1587 11.9999 17.1587C11.4426 17.1587 10.9909 16.7069 10.9909 16.1497V13.009H7.85038C7.29314 13.009 6.84141 12.5572 6.84141 12C6.84141 11.4428 7.29314 10.991 7.85038 10.991H10.9909V7.85029C10.9909 7.29306 11.4426 6.84133 11.9999 6.84133Z"></path>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.15867 2C4.30962 2 2 4.30962 2 7.15867V16.8413C2 19.6904 4.30962 22 7.15867 22H16.8413C19.6904 22 22 19.6904 22 16.8413V7.15867C22 4.30962 19.6904 2 16.8413 2H7.15867ZM4.01793 7.15867C4.01793 5.42409 5.42409 4.01793 7.15867 4.01793H16.8413C18.5759 4.01793 19.9821 5.42409 19.9821 7.15867V16.8413C19.9821 18.5759 18.5759 19.9821 16.8413 19.9821H7.15867C5.42409 19.9821 4.01793 18.5759 4.01793 16.8413V7.15867Z"></path>
                </svg>

                Pr√©senter un Projet
                
              <style>

              .create-presentation-button{
                border-radius: 15px;
              }

                .bordered-plus-sign{
                  margin-bottom: 4px;
                  display: inline-block;
                  fill: currentColor;
                }

                header .create-presentation-button:hover {
                  filter: brightness(0.96);
                }
              
              </style>

            </a>

          </li>

        {# tiny screens display #}
        
        <li class="nav-item d-md-none">
          <button class="btn btn-link p-0 navbar-search-trigger" type="button" data-search-trigger aria-label="Rechercher">
            <svg id="search_icon_small_screens" class="navbar-search-icon" viewBox="0 0 50.798 50.931" aria-hidden="true" focusable="false">
              <g transform="translate(-23.902 -26.869)">
                <path fill="currentColor" d="m61 59.8-0.4 0.4-1.2-1.2c2.7-3.5 4.2-7.7 4.2-12.2 0-5.3-2.1-10.3-5.8-14.1-8-8-21.3-7.8-28.9 0.8-7 7.8-6.6 20.1 0.9 27.5 3.9 3.8 8.9 5.7 14 5.7 4.3 0 8.6-1.4 12.2-4.2l1.2 1.2-0.5 0.3 12.9 12.9c1.2 1.2 3.1 1.2 4.2 0 1.2-1.2 1.2-3.1 0-4.2zm-27.9-2.5c-5.8-5.8-5.8-15.3 0-21.1 2.9-2.9 6.7-4.4 10.6-4.4 3.8 0 7.6 1.5 10.6 4.4 2.8 2.8 4.4 6.6 4.4 10.6s-1.6 7.7-4.4 10.6c-5.9 5.7-15.3 5.7-21.2-0.1z"></path>
              </g>
            </svg>
          </button>
        </li>

        {% if showThemeSelector|default(false) %}
          {% include "_partials/theme_selector.html.twig" with {
            dropdownId: 'themeDropdownSm',
            wrapperClass: 'd-inline-flex d-md-none ms-3',
            iconClass: 'd-inline-block cursor-pointer',
            iconWidth: 30
          } %}
        {% endif %}

        {# search bar for large screens #}

        <div class="d-none d-md-block position-relative">
          <input id="navbar_md_search_input" class="form-control d-inline me-2" type="search" placeholder="Rechercher un Projet" aria-label="Search" autocomplete="off" data-search-trigger>
        </div>

        {# styles for search bar for large screens #}

        <style>

          #navbar_md_search_input{
            width: 220px;
          }

          @media screen and (max-width: 860px) {
            #navbar_md_search_input{
              width: 169px;
            }
          }

        </style>

      </ul>

      {# User Account Menu #}

      {% set userAccountMenu %} {# The html structure is stored in a variable so that we reuse it according to tiny screens or large screens #}

        {% if app.user %}

          <div class="theme-surface">

            {# Displaying user pseudo #}

            <div class="container d-flex align-items-center justify-content-center text-center my-3">
              {{app.user.username}}
            </div>

            <ul class="ps-0" style="list-style:none;">

              {# Access add a project presentation button #}

              <li>
    
                <a class="dropdown-item" href="{{path ('create_project_presentation')}}">Ajouter un Projet</a>
    
              </li>

              {# Access user presented projects list button #}
    
              <li>
    
                <a class="dropdown-item" href="{{path("user_profile_show", {'usernameSlug': app.user.usernameSlug})}}">
                  Mes Projets pr√©sent√©s
                </a>
    
              </li>

              <li>
                <a class="dropdown-item" href="{{ path('user_bookmarks_index') }}">
                  Mes marque-pages
                </a>
              </li>
    
              {# Dropdown Divider #}
    
              <li>
    
                <hr class="dropdown-divider">
    
              </li>

              {# Access user account button #}
    
              <li>
    
                <a class="dropdown-item" href="{{path("user_profile_show", {'usernameSlug': app.user.usernameSlug})}}">
                  Mon Compte
                </a>
    
              </li>
    
              {# Dropdown Divider #}
    
              <li>
    
                <hr class="dropdown-divider">
    
              </li>
    
              {# logout button #}
    
              <li>
    
                <a class="dropdown-item" href="{{path('app_logout')}}">
    
                  D√©connexion
    
                </a>
    
              </li>
            
            </ul>

          </div>
      
        {% endif %}

      {% endset %}
      
      
      {# Tiny screens only: button to trigger hide menu / show menu #}

      <button class="btn navbar-toggler" data-bs-target="#navbarSMToggle" aria-controls="navbarSMToggle" type="button" data-bs-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">

        <span class="navbar-toggler-icon"></span>

      </button>

      {# Some navbar elements #}
      
      <div id="navbarSMToggle" class="collapse navbar-collapse text-center">{# Note : tiny screens elements are collapsed in this #navbarSMToggle div panel (toggle button just above), but >= md screens elements appearsnormally in the navbar without toggling a button #}
      
        {# This div is collapsed and displayed only on small screens #}

        <div class="d-md-none">

          {{ userAccountMenu }} {# Setted above #}

        </div>

        <ul class="navbar-nav ms-md-auto gap-2">

          {# Theme selection (optional) #}

          {% if showThemeSelector|default(false) %}
            {% include "_partials/theme_selector.html.twig" with {
              dropdownId: 'themeDropdownLg',
              wrapperClass: 'd-none d-md-inline-flex'
            } %}
          {% endif %}


          {# Access admin panel icon (admins only) #}
          
          {% if is_granted("ROLE_ADMIN") %}
          
            <li class="nav-item d-none d-md-inline">

              <a href="{{path ('admin')}}">

                <img class="navbar-icon icon-themed icon-strong px-1 py-1 mt-1 rounded" src="{{ asset('key.svg', 'misc')}}" alt="key icon" style="height:32px;">

              </a>

            </li>
        
          {% endif %} 

          {% if not app.user %}

            {# login access button (>= md screens) #}

            <a href="{{ path('app_login') }}" class="d-none d-md-block btn btn-outline-primary fw-bold me-2">Connexion</a>

            {# login access button (sm screens) #}

            <div class="d-md-none text-center sm-auth-panel">

              <h4 class="fw-bold text-center mt-4 mb-1 sm-auth-title">Se connecter</h4>
              <p class="sm-auth-subtitle mb-3">Choisissez une m√©thode de connexion.</p>

              <div class="sm-connect-list">

              {# login with Google button #}
                
              <a class="sm-connect-btn btn" href="{{ path('connect_google_start') }}" aria-label="Continuer avec Google">
                <img src="{{asset ('connect/google.svg', 'misc')}}" alt="Google" loading="lazy" width="50" height="50">
                <span>Continuer avec Google</span>
              </a>

              {# login with Facebook button #}

              <a class="sm-connect-btn btn" href="{{ path('connect_facebook_start') }}" aria-label="Continuer avec Facebook">
                  <img src="{{asset ('connect/facebook.svg', 'misc')}}" alt="Facebook" loading="lazy" width="50" height="50">
                  <span>Continuer avec Facebook</span>
              </a>

              {# login with Email button #}
              
              <a class="sm-connect-btn btn" href="{{path('app_login')}}" aria-label="Continuer avec e-mail">
                <svg class="sm-connect-btn__icon sm-connect-btn__icon--email" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M4.2 5.6h15.6a1.6 1.6 0 0 1 1.6 1.6v9.6a1.6 1.6 0 0 1-1.6 1.6H4.2a1.6 1.6 0 0 1-1.6-1.6V7.2a1.6 1.6 0 0 1 1.6-1.6Z" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="m3.6 7.1 8.4 5.8 8.4-5.8" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Continuer avec e-mail</span>
              </a>

              </div>

            </div>

          {% endif %}

          {# This dropdown menu is displayed only >= md screens #}

          {# User Account Dropdown Menu #}

          {% if app.user %}

            <li class="d-none d-md-block nav-item dropdown rounded">
            
            {# Trigger wrap dropdown / unwrap dropdown button #}

              <button
                id="userAccountDropdown"
                class="dropdown-toggle btn btn-outline-primary fw-bold"
                type="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                style="padding: 6px 9px; margin-right: 10px;"
              >

                üë§ {{app.user.username | truncate (15) }}

              </button>

              {# User Account Dropdown Menu Content #}

              <ul aria-labelledby="userAccountDropdown" class="dropdown-menu dropdown-menu-end" style="width: 260px;">

                {{ userAccountMenu }} {# Setted above #}

              </ul>


            </li>

          {% endif %}

        </ul>

      </div>

    </div>

  </nav>

</header>

<style>

  .navbar{
    z-index: 30;
  }

  .dropdown-item{
    font-size: 1.15em;
  }

  @media screen and (max-width: 580px) {

    .static-menu {

      display: contents;

    }

  }

</style>
