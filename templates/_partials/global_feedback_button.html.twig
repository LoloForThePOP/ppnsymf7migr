{% set currentRoute = app.request.attributes.get('_route')|default('unknown_route') %}
{% set currentPath = app.request.pathInfo|default('/') %}
{% set mode = mode|default('floating') %}
{% set href = path('contact_us', { context: 'feedback', item: currentRoute, identifier: currentPath }) %}

{% if currentRoute != 'contact_us' %}
    {% if mode == 'inline' %}
        <div class="global-feedback-inline-slot">
            <a
                class="global-feedback-button global-feedback-button--inline btn btn-validate btn-no-icon"
                href="{{ href }}"
                aria-label="Envoyer un retour"
                title="Envoyer un retour"
            >
                <svg class="global-feedback-button__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M4.5 5.25a2.25 2.25 0 0 1 2.25-2.25h10.5A2.25 2.25 0 0 1 19.5 5.25v7.5A2.25 2.25 0 0 1 17.25 15H9.06l-3.78 3.32c-.48.43-1.28.09-1.28-.55V5.25Zm2.25-.75a.75.75 0 0 0-.75.75v10.86l2.5-2.2a.75.75 0 0 1 .5-.19h8.25a.75.75 0 0 0 .75-.75v-7.5a.75.75 0 0 0-.75-.75H6.75Z" fill="currentColor"/>
                </svg>
                <span>Envoyer un retour</span>
            </a>
        </div>
    {% else %}
        <a
            class="global-feedback-button global-feedback-button--floating btn btn-validate btn-no-icon"
            href="{{ href }}"
            aria-label="Envoyer un retour"
            title="Envoyer un retour"
        >
            <svg class="global-feedback-button__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="M4.5 5.25a2.25 2.25 0 0 1 2.25-2.25h10.5A2.25 2.25 0 0 1 19.5 5.25v7.5A2.25 2.25 0 0 1 17.25 15H9.06l-3.78 3.32c-.48.43-1.28.09-1.28-.55V5.25Zm2.25-.75a.75.75 0 0 0-.75.75v10.86l2.5-2.2a.75.75 0 0 1 .5-.19h8.25a.75.75 0 0 0 .75-.75v-7.5a.75.75 0 0 0-.75-.75H6.75Z" fill="currentColor"/>
            </svg>
            <span>Envoyer un retour</span>
        </a>
    {% endif %}
{% endif %}
