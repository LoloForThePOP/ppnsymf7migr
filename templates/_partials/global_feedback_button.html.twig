{% set currentRoute = app.request.attributes.get('_route')|default('unknown_route') %}
{% set currentPath = app.request.pathInfo|default('/') %}
{% set mode = mode|default('floating') %}
{% set href = path('contact_us', { context: 'feedback', item: currentRoute, identifier: currentPath }) %}

{% if currentRoute != 'contact_us' %}
    {% if mode == 'inline' %}
        <div class="global-feedback-inline-slot">
            <a
                class="global-feedback-button global-feedback-button--inline btn btn-validate btn-no-icon"
                href="{{ href }}"
                aria-label="Envoyer un retour"
                title="Envoyer un retour"
            >
                <svg class="global-feedback-button__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none">
                    <path d="M6.75 4.5h10.5A2.25 2.25 0 0 1 19.5 6.75v7.5a2.25 2.25 0 0 1-2.25 2.25H9l-3.72 3.25a.75.75 0 0 1-1.24-.56V6.75A2.25 2.25 0 0 1 6.75 4.5Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8.25 9h7.5M8.25 12h4.8" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Envoyer un retour</span>
            </a>
        </div>
    {% else %}
        <a
            class="global-feedback-button global-feedback-button--floating btn btn-validate btn-no-icon"
            href="{{ href }}"
            aria-label="Envoyer un retour"
            title="Envoyer un retour"
        >
            <svg class="global-feedback-button__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none">
                <path d="M6.75 4.5h10.5A2.25 2.25 0 0 1 19.5 6.75v7.5a2.25 2.25 0 0 1-2.25 2.25H9l-3.72 3.25a.75.75 0 0 1-1.24-.56V6.75A2.25 2.25 0 0 1 6.75 4.5Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M8.25 9h7.5M8.25 12h4.8" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Envoyer un retour</span>
        </a>
    {% endif %}
{% endif %}
