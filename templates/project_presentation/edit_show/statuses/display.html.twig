{# Status pills macro #}
{% macro pill(item) %}
    <span class="status-pill-view px-3 py-2 rounded-pill text-dark fw-semibold"
          data-status="{{ item.uniqueName }}"
          data-text="{{ item.short_description_fr }}"
          style="background-color: {{ item.bg_color }};"
          title="{{ item.description_fr }}">
        {{ item.short_description_fr }}
    </span>
{% endmacro %}

{% import _self as pills %}

{# Project statuses view (a collection of enumerated status pills + remarks) #}
<div class="project-statuses-view">
    <div class="project-enumerated-statuses-view d-flex flex-wrap gap-2"
         data-current-statuses='{{ presentation.statuses | json_encode }}'
         data-catalog="{{ statusesCatalog | json_encode }}">
        {% for item in presentation.getEnumStatusItems() %}
            {{ pills.pill(item) }}
        {% endfor %}
    </div>

    <div class="project-status-remarks-view mt-3 w-100">
        <div class="content">{{ presentation.statusRemarks }}</div>
    </div>

    {# Optional popover trigger to preview statuses #}
    <button type="button" class="btn btn-outline-primary btn-sm mt-2 status-popover-btn">
        Afficher +
    </button>

</div>


<style>
    .project-status-remarks-view .content {
        white-space: pre-wrap;
        max-width: 390px;
    }

    .project-statuses-view{
        display: inline-block;
        border: 1px solid grey;
        padding: 17px;
        border-radius: 6px;
        max-width: 420px;
    }

    .project-statuses-view .content {
        border: 1px solid #d7d7d7;
        padding: 4px 11px;
        border-radius: 7px;
    }

    .project-statuses {
        margin-top: 1rem;
    }

    .status-pill {
        font-size: 0.9rem;
        color: #222;
        border: 1px solid rgba(0,0,0,0.05);
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        cursor: default;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .status-pill:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }

    .status-pill.active {
        outline: 2px solid #4b9c3f;
        font-weight: 600;
    }

    .wide-popover {
        max-width: 400px !important;
    }
</style>
