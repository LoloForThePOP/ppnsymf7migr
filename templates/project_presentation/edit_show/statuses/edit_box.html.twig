




{# Modal Box for Menu Buttons #}

{% embed "utilities/modal_skeleton.html.twig" 

    with {
        
        'modal_id': "project_status_edition",
        'modal_size': "modal-fullscreen modal-dialog-scrollable"
        
    } 
    
%}

    {% block modalTitle %}
    
        <h5 class="modal-title w-100 fw-bold text-center py-md-3">
            
            <img class="mb-1 me-2" src="{{ asset('progress_status.svg', 'pp_wysiwyg')}}" alt="project status icon" width="27">
                
            Statut <br class="d-md-none"> (État Actuel du Projet)
                
        </h5>
        
    {% endblock %}

    {# Project Status Selection Buttons Display #}

    {% block modalBody %}

        {# Notification to user copntainer #}

        <div class="status-editor container px-0 px-md-4 py-3">

            <div class="status-editor__intro">
                <div class="status-editor__intro-text">
                    Sélectionnez les boutons qui correspondent à votre situation.
                </div>
            </div>

            {# User can choose some enumerated status types #}

            <div id="project-statuses-editor" class="status-editor__grid" data-update-url="{{ path('ajax_project_statuses_update', { stringId: presentation.stringId }) }}"
                data-csrf-token="{{ csrf_token('project_statuses_update') }}"
>

                {% for statusCategory in statusesCatalog %}

                {% set uniqueCategoryName = statusCategory.categoryLabels.uniqueName %}

                <div class="project-statuses status-type-list-container d-inline-block">

                    <h5 class="category-title" data-bs-toggle="collapse" href="#category-{{uniqueCategoryName}}">
                        
                        {{ statusCategory.categoryLabels.description_fr }}
                        <span class="category-title-chevron">▾</span>
                    
                    </h5>

                    <ul id="category-{{uniqueCategoryName}}" class="list-group collapse">

                        {% for item in statusCategory.items %}

                        {% set isActive = item.uniqueName in thisProjectActiveStatuses %} {# Checking if surrent status item is selected #}
                
                            <li 
                                class=" {{ isActive ? 'active ' }}
                                
                                    project-status-button 
                                    status-pill
                                    rounded-pill
                                    list-group-item 
                                    list-group-item-action 
                                    py-2
                                    mb-3

                                " 

                                data-status="{{ item.uniqueName }}"
                                data-category="{{ uniqueCategoryName }}"
                                title="{{ item.description_fr }}"
                                                                
                            >

                                {{ item.description_fr }}
                        
                            </li>
                        
                        {% endfor %}
                            
                    </ul>

                </div>

                    
                {% endfor %}



            </div>

            {# User can add some infos and remarks #}

            <div class="status-editor__footer mt-4">

                <div class="textarea-container status-editor__remarks d-flex flex-column align-items-center p-4">

                    <label for="status-remarks-textarea" class="form-label fw-bold">Ici vous pouvez ajouter des précisions ou des détails sur l'avancement du projet :</label>

                    <textarea 
                    
                        id="status-remarks-textarea"
                        class="form-control"
                        rows="3"
                        placeholder="Ajoutez des précisions sur l'avancement...">{{ presentation.statusRemarks }}</textarea>

                    <small class="text-muted d-none" id="remarks-feedback"></small>

                </div>

                <div class="status-editor__actions">
                    <button type="button" class="btn btn-light status-editor__confirm px-4 py-2" data-bs-dismiss="modal">Ok</button>
                </div>

            </div>

        </div>
















    
<style>

    #project_status_edition .modal-content {
        background-color: var(--theme-bg);
        color: var(--theme-text);
    }

    #project_status_edition .modal-header {
        border-bottom: 1px solid var(--theme-border);
    }

    #project_status_edition .modal-title {
        color: var(--theme-title);
    }

    #project_status_edition .modal-title img {
        display: inline-block;
    }

    html[data-theme-variant="custom"] body[data-theme-scope="presentation"] #project_status_edition .modal-title img {
        filter: brightness(0) saturate(100%) var(--theme-icon-filter);
    }

    .status-editor {
        max-width: 1200px;
    }

    .status-editor__intro {
        border-radius: 16px;
        border: 1px solid var(--theme-border);
        background-color: var(--theme-surface-alt);
        background-image: linear-gradient(
            180deg,
            color-mix(in srgb, var(--theme-accent) 12%, transparent),
            transparent
        );
        padding: 16px 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        margin-bottom: 24px;
    }

    .status-editor__intro-text {
        font-size: 1rem;
        font-weight: 600;
        color: var(--theme-text);
    }

    .status-editor__grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 16px;
    }

    .status-type-list-container{

        min-width: 240px;
        min-height: 360px;
        padding: 14px 14px 10px;
        border-radius: 16px;
        border: 1px solid var(--theme-border);
        background-color: var(--theme-surface);
        box-shadow: 0 8px 22px rgba(0, 0, 0, 0.08);

    }

    .status-type-list-container .category-title {

        display: flex;
        align-items: center;
        justify-content: center;

        font-size: 1rem;

        text-align: center;
        
        min-height: 52px;

        padding: 8px 12px;
        margin-bottom: 16px;
        border-radius: 999px;

        font-weight: bold;
        color: var(--theme-title);
        border: 1px solid var(--theme-border);
        background-color: var(--theme-surface-alt);
        cursor:pointer;
        gap: 8px;

    }

    .status-type-list-container .category-title:hover {
        border-color: var(--theme-accent);
        color: var(--theme-accent);
        background-color: var(--theme-surface-alt);
        background-image: linear-gradient(
            180deg,
            color-mix(in srgb, var(--theme-accent) 12%, transparent),
            transparent
        );
    }

    .category-title-chevron {
        font-weight: 700;
        opacity: 0.7;
    }

    .status-type-list-container .list-group {
        border: none;
        padding: 0;
        margin: 0;
        background: transparent;
    }

    .project-status-button{
        cursor: pointer;
        font-size: 0.98rem;
        line-height: 1.15;
        background-color: var(--theme-surface-alt);
        color: var(--theme-text);
        border-color: var(--theme-border);
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease, color 0.2s ease;
    }

    .project-status-button:hover {
        background-color: var(--theme-surface);
        border-color: var(--theme-accent);
        color: var(--theme-accent);
    }

    .status-hover{
        cursor: pointer;
        font-size: larger;
    }

    .project-status-button.list-group-item-action.active {
        color: var(--theme-text);
        z-index: 2;
        background-color: var(--theme-surface-alt);
        background-image: linear-gradient(
            180deg,
            color-mix(in srgb, var(--theme-accent) 18%, transparent),
            transparent
        );
        border-color: var(--theme-accent);
        box-shadow: 0 0 0 1px var(--theme-accent);
    }

    .statusIcon {
        width: 20px;
        height: 20px;
        margin-right: 20px;
    }


    #project_status_edition .textarea-container {
        width: 100%;
        max-width: 860px;
        border: 1px solid var(--theme-border);
        background-color: var(--theme-surface-alt);
        border-radius: 18px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }

    #project_status_edition #status-remarks-textarea {
        border-color: var(--theme-border);
        background-color: var(--theme-surface);
        color: var(--theme-text);
    }

    #project_status_edition #status-remarks-textarea::placeholder {
        color: var(--theme-text-muted);
    }

    #project_status_edition .status-editor__footer {
        display: flex;
        gap: 24px;
        align-items: stretch;
    }

    #project_status_edition .status-editor__remarks {
        flex: 1 1 auto;
    }

    #project_status_edition .status-editor__actions {
        min-width: 160px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #project_status_edition .status-editor__confirm {
        border-radius: 14px;
        border: 1px solid var(--theme-border);
        background-color: var(--theme-surface-alt);
        color: var(--theme-text);
        font-weight: 600;
        box-shadow: none;
    }

    #project_status_edition .status-editor__confirm:hover,
    #project_status_edition .status-editor__confirm:focus {
        background-color: var(--theme-surface);
        border-color: var(--theme-border);
        color: var(--theme-text);
        box-shadow: 0 0 0 1px color-mix(in srgb, var(--theme-border) 80%, transparent);
    }

    #project_status_edition .status-editor__confirm:focus-visible {
        outline: 2px solid color-mix(in srgb, var(--theme-accent) 35%, var(--theme-border));
        outline-offset: 2px;
    }



    @media screen and (max-width: 1200px) {

        .modal-header-in-body{

            padding: 0.6rem 0 0.8rem 0;

        }


        .status-type-list-container{
            min-height: unset;
        }

        .status-type-list-container .category-title {
            font-size: 1rem;
        }

    }

    @media screen and (max-width: 992px) {
        #project_status_edition .status-editor__footer {
            flex-direction: column;
        }

        #project_status_edition .status-editor__actions {
            min-width: unset;
            justify-content: flex-end;
        }
    }

</style>

    {% endblock %}

    {% block modalFooter %}{% endblock %}























{% endembed %}
