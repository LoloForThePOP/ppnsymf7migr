{% extends 'base.html.twig' %}

{% block title %}Modifier une News{% endblock %}

{% block body %}

<script src="/js/tinymce/js/tinymce/tinymce.min.js" referrerpolicy="origin"></script>

<div class="page-container container col-md-8 px-0 px-md-3 mb-4">

    <h1 class="h3 text-center fw-bold mb-4 mb-md-5">Modifier une News</h1>

    {% set changeImageInfo = "Pour modifier l'image, cliquez ci-dessous" %}

    <div class="container px-0 px-md-3">

        {{ form_start(newsForm) }}

        <div class="news-edit-card rounded p-2 p-md-3 mb-3">

            {{form_row(newsForm.textContent)}}

        </div>

        <div class="news-edit-card rounded p-3 mb-3">

            {{form_label(newsForm.image1File)}}
            
            {% if news.image1 is not empty %}

                <div class="mb-3">

                    <div class="">
                    
                        <img class="news-image" src="{{ vich_uploader_asset(news,'image1File') }}" alt="{{ news.captionImage1 ?? 'Image 1 de la news' }}">
                    
                    </div>

                
                </div>

                <div class="fw-bold mb-2">{{changeImageInfo}}</div>

            {% endif %}

            <div class="mb-3">{{form_widget(newsForm.image1File)}}</div>
            {{form_row(newsForm.captionImage1)}}
        
        </div>

        <div class="news-edit-card rounded p-3 mb-3">

            {{form_label(newsForm.image2File)}}
            
            {% if news.image2 is not empty %}

                <div class="mb-3">

                    <div class="">
                    
                        <img class="news-image" src="{{ vich_uploader_asset(news,'image2File') }}" alt="{{ news.captionImage2 ?? 'Image 2 de la news' }}">
                    
                    </div>

                </div>

                <div class="fw-bold mb-2">{{changeImageInfo}}</div>

            {% endif %}

            <div class="mb-3">{{form_widget(newsForm.image2File)}}</div>
            {{form_row(newsForm.captionImage2)}}
        
        </div>

        <div class="news-edit-card rounded p-3 mb-3">

            {{form_label(newsForm.image3File)}}
            
            {% if news.image3 is not empty %}

                <div class="mb-3">

                    <div class="">
                    
                        <img class="news-image" src="{{ vich_uploader_asset(news,'image3File') }}" alt="{{ news.captionImage3 ?? 'Image 3 de la news' }}">
                    
                    </div>

                </div>

                <div class="fw-bold mb-2">{{changeImageInfo}}</div>

            {% endif %}

            <div class="mb-3">{{form_widget(newsForm.image3File)}}</div>
            {{form_row(newsForm.captionImage3)}}
        
        </div>
        

        <div class="mt-5 d-flex justify-content-center">

            <a href="{{path('edit_show_project_presentation', {'stringId': ppStringId, '_fragment': 'news-struct-container' })}}">

                <button type="button" class="btn btn-go-back me-5">Annuler</button>

            </a>

            <button id="" type="submit" class="btn btn-validate">Valider</button>

        </div>


        {{ form_end(newsForm) }}

    </div>


</div>

<script>

 $(document).ready(function(){

    const buildTinyMceContentStyle = function (padding) {
        const rootStyles = getComputedStyle(document.documentElement);
        const themeSurface = rootStyles.getPropertyValue('--theme-surface').trim() || getComputedStyle(document.body).backgroundColor;
        const themeText = rootStyles.getPropertyValue('--theme-text').trim() || getComputedStyle(document.body).color;
        const themeFont = rootStyles.getPropertyValue('--theme-font-body').trim() || 'Lato, sans-serif';
        const safePadding = padding || '0 15px';

        return 'body { background-color: ' + themeSurface + '; color: ' + themeText + '; font-family: ' + themeFont + '; padding: ' + safePadding + '; line-height: 1.5; }';
    };

    tinymce.init({
        selector: 'textarea#news_textContent',
        plugins: 'charmap emoticons lists wordcount',
        toolbar: 'undo redo bold italic underline strikethrough bullist emoticons charmap',
        menubar: '',
        height: "300px",
        language: 'fr_FR',
        license_key: 'gpl',
        content_style: buildTinyMceContentStyle(),

    });


    //Delete Image Rendering
    $(".form-check-label").html("Cocher cette case pour supprimer l'image");
    $(".form-check").addClass("mt-2")


});

</script>


<style>

    .news-image{
        max-width: 200px;
        height: auto;
    }

    .news-edit-card {
        border: 1px solid color-mix(in srgb, var(--theme-accent) 55%, var(--theme-border));
        background-color: var(--theme-surface);
        box-shadow: var(--pp-card-shadow, 0 10px 22px rgba(0, 0, 0, 0.08));
        border-radius: 16px;
    }


</style>



{% endblock %}
